<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¹¸é‹è¼ªç›¤æŠ½ç</title>
  <link rel="stylesheet" href="./css/styles.css">
</head>

<body>
  <div class="container">
    <h1>å¹¸é‹è¼ªç›¤æŠ½ç</h1>

    <!-- è¼ªç›¤å®¹å™¨ -->
    <div id="lottery-container">
      <!-- è¼ªç›¤åœ–ç‰‡ -->
      <img id="tunableImg" src="images/wheel.svg" alt="æŠ½çè¼ªç›¤" class="wheel">
      <!-- æŒ‡é‡åœ–ç‰‡ -->
      <img id="arrowImg" src="images/pointer.svg" alt="æŒ‡é‡" class="pointer boxJumpAnimatePaused">
    </div>

    <!-- æŠ½çèªªæ˜ -->
    <div class="instructions">
      <p>é»æ“ŠæŒ‡é‡é–‹å§‹æŠ½ç</p>
      <button id="manual-spin">æ‰‹å‹•æŠ½ç</button>
    </div>

    <!-- çµæœå½ˆçª— -->
    <div id="common_pop" class="popup hidden">
      <div class="popup-content">
        <div class="close-btn">&times;</div>
        <h2 id="prizeName"></h2>
        <div class="prize-image">
          <img id="popup_img" src="" alt="çå“åœ–ç‰‡">
        </div>
        <div id="prizeTxt" class="prize-text"></div>

        <!-- çå“çµæœé¡¯ç¤ºå€åŸŸ -->
        <div class="award_result hidden">
          <p>æ­å–œæ‚¨ç²å¾—äº†çå“ï¼</p>
        </div>
        <div class="award_result hidden">
          <p>æ­å–œæ‚¨ç²å¾—äº†ç‰¹æ®Šçå“ï¼</p>
        </div>

        <button class="confirm-btn">ç¢ºå®š</button>
      </div>
    </div>
  </div>

  <!-- å¼•å…¥JavaScriptæ–‡ä»¶ -->
  <script type="module">
    import { LuckyWheel } from './js/es6.lucky.wheel.2.1.2.js';

    // é é¢åŠ è¼‰å®Œæˆå¾Œçš„é¡å¤–åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function () {
      // é—œé–‰å½ˆçª—
      document.querySelector('.close-btn').addEventListener('click', function () {
        document.getElementById('common_pop').classList.add('hidden');
      });

      document.querySelector('.confirm-btn').addEventListener('click', function () {
        document.getElementById('common_pop').classList.add('hidden');
      });

      // æ‰‹å‹•æŠ½çæŒ‰éˆ•
      document.getElementById('manual-spin').addEventListener('click', function () {
        // å‰µå»ºè¼ªç›¤å¯¦ä¾‹ï¼Œå¯ä»¥è‡ªå®šç¾©é…ç½®
        const wheel = new LuckyWheel({
          prizes: [
            { name: 'Green Agate | Raw Crystal', image: 'images/pop_img/01_pop.jpg', text: '' },
            { name: 'Fortune Gold $100', image: 'images/pop_img/03_pop.jpg', text: 'Expires: <span>2025-03-20</span>' },
            { name: '30-Day Divine Offering', image: 'images/pop_img/04_pop.jpg', text: 'Expires: <span>2025-03-20</span>' },
            { name: 'Instant Voucher', image: 'images/pop_award/04.jpg', text: '' },
            { name: 'Thanks for Playing', image: 'images/pop_img/00_pop.jpg', text: '', hideText: true },
            { name: 'Fortune Gold $50', image: 'images/pop_img/05_pop.jpg', text: 'Expires: <span>2025-03-20</span>' },
            { name: 'Zi Wei Career Luck', image: 'images/pop_img/02_pop.jpg', text: 'Expires: <span>2025-03-20</span>' },
          ],
          specialPrizeIndex: 2, // å¯é¸çš„ç‰¹æ®Šçé …ç´¢å¼•
          duration: 5000,
          minSpins: 4,
          easing: 'ease-in-out',
          autoResetDelay: 4000,
          pointerSelector: '#arrowImg',
          wheelSelector: '#tunableImg',
          resultContainer: '#common_pop',
          prizeNameSelector: '#prizeName',
          prizeImageSelector: '#popup_img',
          prizeTextSelector: '#prizeTxt',
          onStart: () => console.log('ğŸ¯ Spin started!'),
          onEnd: (prize, index) => console.log(`ğŸ‰ You won: ${prize.name} (Index: ${index})`),
          onReset: () => console.log('ğŸ” Wheel reset.'),
        });

        // è‹¥éœ€æ‰‹å‹•éŠ·æ¯€ï¼ˆä¾‹å¦‚åœ¨ SPA ä¸­åˆ‡æ›é é¢ï¼‰
        window.addEventListener('pagehide', () => wheel.destroy());
      });
    });
  </script>
</body>

</html>